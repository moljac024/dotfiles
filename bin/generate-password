#!/usr/bin/env bashim
# vim: filetype=sh
set -euo pipefail

N="${1:-8}"
if [[ -n "${1:-}" ]]; then
  if ! [[ "$1" =~ ^[0-9]+$ ]]; then
    echo "Warning: N must be an integer; defaulting to 8." >&2
    N=8
  elif (( N <= 0 )); then
    echo "Warning: N must be > 0; defaulting to 8." >&2
    N=8
  fi
fi

# X = ceil(3/4 * N), so base64 output is >= N chars
X=$(( (N * 3 + 3) / 4 ))

# Strip newline, then cut to exactly N characters
openssl rand -base64 "$X" | LC_ALL=C tr -d '\n' | head -c "$N"
echo
