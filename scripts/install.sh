#!/usr/bin/env bash

################################################################################
### Baseline
################################################################################

link () {
    original=$1
    path=$2
    original_fullpath="$(cd "$(dirname "$original")"; pwd)/$(basename "$original")"

    if [ -L "$path" ]; then
        rm "$path"
    fi

    if [ -e "$path" ]; then
        mv "$path" "$path.old"
    fi

    ln -s "$original_fullpath" "$path"
}


git_clone () {
    repo=$1
    location=$2
    location_fullpath="$(cd "$(dirname "$location")"; pwd)/$(basename "$location")"

    if [ ! -d "$location_fullpath" ]; then
        git clone "$repo" "$location_fullpath"
    fi
}

if [[ ! -e $HOME/.config ]] ; then
    mkdir -p $HOME/.config
fi

################################################################################


################################################################################
### Scripts
################################################################################

if [[ "$OSTYPE" == "darwin"* ]]; then
    link src/scripts/osx $HOME/bin
else
    link src/scripts/linux $HOME/bin
fi

################################################################################

################################################################################
### Bash
################################################################################

link src/bash/.bash_profile $HOME/.bash_profile
link src/bash/.bashrc $HOME/.bashrc

git_clone https://github.com/Bash-it/bash-it.git $HOME/.bash_it

################################################################################


################################################################################
### Zsh
################################################################################

mkdir -p $HOME/.zsh/functions
mkdir -p $HOME/.zsh/prompts

link src/zsh/.zshenv $HOME/.zshenv
link src/zsh/.zshrc $HOME/.zshrc

# git_clone https://github.com/robbyrussell/oh-my-zsh.git $HOME/.oh-my-zsh

git_clone https://github.com/sindresorhus/pure.git $HOME/.zsh/prompts/pure
link $HOME/.zsh/prompts/pure/pure.zsh $HOME/.zsh/functions/prompt_pure_setup
link $HOME/.zsh/prompts/pure/async.zsh $HOME/.zsh/functions/async

################################################################################


################################################################################
### Fish
################################################################################

mkdir -p $HOME/.config/fish/functions
link src/fish/config.fish $HOME/.config/fish/config.fish
link src/fish/fishfile $HOME/.config/fish/fishfile
curl https://git.io/fisher --create-dirs -sLo $HOME/.config/fish/functions/fisher.fish && fish -c fisher

################################################################################


################################################################################
### Git
################################################################################

link src/git/.gitconfig $HOME/.gitconfig
link src/git/.gitignore_global $HOME/.gitignore_global

################################################################################


################################################################################
### Vim
################################################################################

mkdir -p $HOME/.vim/autoload
link src/vim/autoload/plug.vim $HOME/.vim/autoload/plug.vim
link src/vim/vimrc $HOME/.vim/vimrc

################################################################################


################################################################################
### Neovim
################################################################################

mkdir -p $HOME/.local/share/nvim/site/autoload
mkdir -p $HOME/.config/nvim
link src/vim/autoload/plug.vim $HOME/.local/share/nvim/site/autoload/plug.vim
link src/vim/vimrc $HOME/.config/nvim/init.vim

################################################################################


################################################################################
### Ripgrep
################################################################################

link src/.ripgreprc $HOME/.ripgreprc

################################################################################

################################################################################
### Kitty
################################################################################

link src/kitty $HOME/.config/kitty

################################################################################

################################################################################
### Ranger
################################################################################

link src/ranger $HOME/.config/ranger

################################################################################

################################################################################
### Tmux
################################################################################

link src/tmux/.tmux.conf $HOME/.tmux.conf

################################################################################


################################################################################
### Tmuxinator bash completions
################################################################################

mkdir -p $HOME/.bash_completions
link src/tmux/tmuxinator-completion.bash $HOME/.bash_completions/tmuxinator

################################################################################


################################################################################
### Asdf version manager
################################################################################

git_clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.7.2

################################################################################

################################################################################
### Xorg
################################################################################

link src/xorg/.Xdefaults $HOME/.Xdefaults

################################################################################

################################################################################
### i3 wm
################################################################################

link src/i3 $HOME/.config/i3

################################################################################

################################################################################
### sway wm
################################################################################

link src/sway $HOME/.config/sway

################################################################################

################################################################################
### polybar
################################################################################

link src/polybar $HOME/.config/polybar

################################################################################

